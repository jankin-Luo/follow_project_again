{"name": "获取物料", "status": "failed", "statusDetails": {"message": "AssertionError", "trace": "self = <common.assertions.Assertions object at 0x1041bfd90>\nexpected = [{'contains': {'code': '20000'}}], response = {'msg': '未携带cookie信息'}\nstatus_code = 200\n\n    def assert_result(self, expected, response, status_code):\n        '''\n        断言模式，通过all_flag标记\n        :param expoected:预期结果\n        :param response:接口实际返回结果\n        :param status_code:接口实际返回状态码\n        :return:\n        '''\n        # 0代表成功\n        all_flag = 0\n        try:\n            for yq in expected:\n                for k, v in yq.items():\n                    if k == 'contains':\n>                       flag = self.contains_assert(v, response, status_code)\n\n../../common/assertions.py:137: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <common.assertions.Assertions object at 0x1041bfd90>\nvalue = {'code': '20000'}, response = {'msg': '未携带cookie信息'}, status_code = 200\n\n    def contains_assert(self, value, response, status_code):\n        '''\n        第一种模式，字符串包含断言，断言预期结果字符串包含在接口返回中\n        :param value:\n        :param response:\n        :param status_code:\n        :return:\n        '''\n        # 断言状态表示，0代表成功，其他代表失败\n        flag = 0\n        for assert_k, assert_v in value.items():\n            # print(assert_k, assert_v)\n            if assert_k == 'status_code':\n                if assert_v != status_code:\n                    flag += 1\n                    allure.attach(f'预期结果:{assert_v}\\n实际结果:{status_code}', '响应代码断言结果:失败', allure.attachment_type.TEXT)\n                    logs.error('contains断言失败，接口返回码{}不等于预期{}'.format(status_code, assert_v))\n            else:\n                res_list = jsonpath.jsonpath(response, '$..%s' % assert_k)\n>               if isinstance(res_list[0], str):\nE               TypeError: 'bool' object is not subscriptable\n\n../../common/assertions.py:39: TypeError\n\nDuring handling of the above exception, another exception occurred:\n\nself = <test_getMaterial.TestUserManager object at 0x104883790>\nbaseinfo = {'api_name': '下单物料', 'header': {'Content-Type': 'application/json;charset=UTF-8'}, 'method': 'get', 'url': '/api/order/customer/orderPlan/getMaterial'}\ntestcase = {'json': 'null'}\n\n    @allure.story(next(t_id) + \"物料下单\")\n    # 测试用例执行顺序设置\n    @pytest.mark.run(order=1)\n    # 参数化，yaml数据驱动\n    @pytest.mark.parametrize('baseinfo,testcase', get_testcase_yaml(\"getMaterial.yaml\"))\n    def test_xiadan(self, baseinfo, testcase):\n        test_id = str(uuid.uuid4())[:8]\n        allure.dynamic.title(testcase['case_name'])\n        allure.dynamic.parameter(\"测试ID\", testcase['case_name'])\n>       BaseRequest().specification_yaml(baseinfo, testcase)\n\ntest_getMaterial.py:35: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n../../base/apiutil.py:119: in specification_yaml\n    raise e\n../../base/apiutil.py:116: in specification_yaml\n    assert_res.assert_result(validation, res_json, res.status_code)\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <common.assertions.Assertions object at 0x1041bfd90>\nexpected = [{'contains': {'code': '20000'}}], response = {'msg': '未携带cookie信息'}\nstatus_code = 200\n\n    def assert_result(self, expected, response, status_code):\n        '''\n        断言模式，通过all_flag标记\n        :param expoected:预期结果\n        :param response:接口实际返回结果\n        :param status_code:接口实际返回状态码\n        :return:\n        '''\n        # 0代表成功\n        all_flag = 0\n        try:\n            for yq in expected:\n                for k, v in yq.items():\n                    if k == 'contains':\n                        flag = self.contains_assert(v, response, status_code)\n                        all_flag += flag\n                    elif k == 'eq':\n                        flag = self.equal_assert(v, response)\n                        all_flag += flag\n                    elif k == 'ne':\n                        flag = self.not_equal_assert(v, response)\n                        all_flag += flag\n                    elif k == 'db':\n                        flag = self.assert_mysql(v)\n                        all_flag += flag\n            assert all_flag == 0\n            logs.info('测试成功')\n        except Exception as e:\n            logs.error('测试失败')\n            logs.error(f'异常信息{e}')\n>           assert False\nE           AssertionError\n\n../../common/assertions.py:153: AssertionError"}, "attachments": [{"name": "接口地址:http://127.0.0.1:8787/api/order/customer/orderPlan/getMaterial", "source": "89db2724-fc7e-4bd2-b87e-9dea24f3d7bd-attachment.attach"}, {"name": "接口名称:下单物料", "source": "4c58a461-3b06-4be9-b490-6c22dff483cc-attachment.attach"}, {"name": "请求方法:get", "source": "5ee10464-76b6-4ca5-92ea-5de62ad1375b-attachment.attach"}, {"name": "请求头:{'Content-Type': 'application/json;charset=UTF-8'}", "source": "a02afef1-81f3-4a2e-8891-6919f9b5a5b9-attachment.txt", "type": "text/plain"}, {"name": "测试用例名称:获取物料", "source": "c49cf7ef-6b42-48a2-8958-a13dde435235-attachment.attach"}, {"name": "请求参数：{\"json\": \"null\"}", "source": "9d9af4ef-ac0b-417b-9fb2-0161ea553d58-attachment.txt", "type": "text/plain"}, {"name": "接口响应信息", "source": "e08e5056-0932-4b34-9d82-007809c0cb4e-attachment.txt", "type": "text/plain"}, {"name": "接口响应码", "source": "6dabaa82-99f3-4989-a186-c12e8e127cb6-attachment.txt", "type": "text/plain"}, {"name": "log", "source": "62d9a2c0-651f-47d1-9c19-5b467b9474a0-attachment.txt", "type": "text/plain"}], "parameters": [{"name": "测试ID", "value": "'获取物料'"}], "start": 1762759512330, "stop": 1762759512337, "uuid": "dd43413b-29af-4c6c-86af-7d1de3ee5392", "historyId": "a3f0823a3f38fa84417e1f35dceb4719", "testCaseId": "1724bbaf3fac08544065436e5077ad22", "fullName": "testcase.getMaterial.test_getMaterial.TestUserManager#test_xiadan", "labels": [{"name": "story", "value": "T002_物料下单"}, {"name": "feature", "value": "M01_智慧物流项目"}, {"name": "parentSuite", "value": "testcase.getMaterial"}, {"name": "suite", "value": "test_getMaterial"}, {"name": "subSuite", "value": "TestUserManager"}, {"name": "host", "value": "gongxydeMacBook-Air.local"}, {"name": "thread", "value": "2446-MainThread"}, {"name": "framework", "value": "pytest"}, {"name": "language", "value": "cpython3"}, {"name": "package", "value": "testcase.getMaterial.test_getMaterial"}], "titlePath": ["testcase", "getMaterial", "test_getMaterial.py", "TestUserManager"]}